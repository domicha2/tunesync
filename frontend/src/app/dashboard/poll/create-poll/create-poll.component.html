<div id="create-poll-wrapper" class="column">
  <h1 mat-dialog-title>Create Poll</h1>
  <mat-dialog-content class="column">
    <mat-horizontal-stepper [linear]="true" #stepper>
      <mat-step [stepControl]="pollType">
        <ng-template matStepLabel>Pick the poll type</ng-template>

        <div id="poll-type" class="row">
          <label id="poll-type-label">Select a poll type:</label>
          <mat-radio-group
            [formControl]="pollType"
            aria-labelledby="poll-type-label"
            required
          >
            <mat-radio-button
              *ngFor="let type of pollTypes"
              [value]="type.enum"
            >
              {{ type.name }}
            </mat-radio-button>
          </mat-radio-group>
        </div>

        <div class="stepper-buttons">
          <button color="accent" mat-raised-button matStepperNext>Next</button>
        </div>
      </mat-step>

      <mat-step [stepControl]="pollType.value === 'U' ? userId : songId">
        <ng-template matStepLabel>
          <ng-container *ngIf="pollType.value === null">
            Select an option
          </ng-container>
          <ng-container *ngIf="pollType.value === 'U'">
            Select a user
          </ng-container>
          <ng-container *ngIf="pollType.value === 'MQ'">
            Select a song
          </ng-container>
        </ng-template>

        <div id="user" class="column" *ngIf="pollType.value === 'U'">
          <mat-form-field appearance="outline">
            <mat-label>User</mat-label>
            <mat-select [formControl]="userId">
              <mat-option
                *ngFor="let user of regularUsers$ | async"
                [value]="user.userId"
              >
                {{ user.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div id="song" class="column" *ngIf="pollType.value === 'MQ'">
          <div id="song-filter" class="column">
            <mat-form-field appearance="outline">
              <mat-label>Name</mat-label>
              <input type="text" matInput [formControl]="nameControl" />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Artist</mat-label>
              <input type="text" matInput [formControl]="artistControl" />
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Album</mat-label>
              <input type="text" matInput [formControl]="albumControl" />
            </mat-form-field>
          </div>

          <mat-form-field appearance="outline">
            <mat-label>Songs</mat-label>
            <mat-select [formControl]="songId">
              <mat-option
                *ngFor="let song of availableSongs$ | async"
                [value]="song.id"
              >
                {{ song.name }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="stepper-buttons">
          <button mat-raised-button matStepperPrevious>Back</button>
          <button color="accent" mat-raised-button matStepperNext>Next</button>
        </div>
      </mat-step>

      <mat-step>
        <ng-template matStepLabel>Done</ng-template>
        <p>You are now done.</p>

        <div class="stepper-buttons">
          <button mat-raised-button matStepperPrevious>Back</button>
          <button mat-raised-button color="warn" (click)="stepper.reset()">
            Reset
          </button>
          <button
            color="accent"
            mat-raised-button
            mat-dialog-close
            (click)="onCreatePoll()"
          >
            Submit
          </button>
        </div>
      </mat-step>
    </mat-horizontal-stepper>
  </mat-dialog-content>
  <mat-dialog-actions>
    <button mat-raised-button mat-dialog-close color="warn">Cancel</button>
  </mat-dialog-actions>
</div>
